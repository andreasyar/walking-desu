#summary game draft

= 1. Игровой мир =

Игровой мир состоит из двух частей. Первая - квадратная карта поверхности шириной *MAP_WIDTH* пикселей. Вторая - набор подземелий и других зон игрового мира не находящихся на поверхности (набор маленьких независимых карт).

== 1.1 Разбиение карты на фрагменты ==

Как поверхность, так и зоны не находящиеся на поверхности, делятся на квадратные фрагменты шириной *MAP_FRAGM_WIDTH*.

== 1.2 Зона видимости карты ==

В один момент времени игрок видит вокруг себя *MAP_VISIBLE_RANGE* фрагментов карты во всех направлениях. В процессе перемещения игрока по карте, игроку становятся видимы другие фрагменты карты, попадающие в *MAP_VISIBLE_RANGE* и становятся не видимы те, которые больше в него не входят.

== 1.3 Типы местности. Местности ==

Фрагменты карты разбиты на квадратные ячейки шириной *MAP_FRAGM_CELL_WIDTH*. Каждой ячейке соответствует один из следующих типов местности: вода, трава, земля, лес, гора. Существует несколько наборов спрайтов для разных местностей (местность покрытая снегом, пустынная местность). В каждом таком наборе спрайтов есть спрайты для каждого типа местности и, если нужно чтобы переходы между различными типами местности выглядели красиво, то в наборе спрайтов должны быть спрайты для ячеек, лежащих на границе разных типов местности. Также, если нужно чтобы переход между разными местностями выглядел красиво, в наборе спрайтов должны быть спрайты для ячеек, лежащих на границе разных местностей.

== 1.4 Геодата ==

Геодата - это собирательное название для механизма, который позволяет воздействовать на игрока, если он находится в какой-то специально выделенной области игрового мира. Термин позаимствован из _Lieage 2_ и отчасти наполнен новым смыслом. В основе геодаты лежат выделенные области игрового мира, при попадании в которые игрока срабатывает триггер, который закреплён за данной выделенной областью. Например, ячейки фрагмента карты, которые имеют тип вода, выделены областью, при попадании в которую игрока срабатывает триггер, который не даёт игроку попасть в эту область. Спрайт телепорта на карте выделен областью, при попадании в которую игрока срабатывает триггер, мгновенно перемещающий игрока в некую точку игрового мира. Спрайты лавы (тип местности земля) местности лавовый поток выделены областью, при попадании в которую игрока срабатывает триггер, который уменьшает здоровье игрока и снижает его скорость передвижения. Области имеют вид многоугольника.

== 1.5 Особые области игрового мира (продолжение 1.4) ==

Изначально существует несколько разновидностей особых областей игрового мира, вернее триггеров, закреплённых за ними:
  * область, в которую нельзя попасть,
  * область, при попадании в которую мгновенно или периодически изменяются атрибуты игрока.
В процессе разработки могут добавиться другие разновидности особых областей, которые смогут влиять не только на игрока, попавшего в них.

== 1.6 Автоматическое создание местности ==

Подразумевается, что *MAP_WIDTH* из пункта 1.1 достаточно большая, чтобы нарисовать руками весь игровой мир было практически невозможно. Поэтому в игровом мире будут как созданные вручную, так и автоматически созданные фрагменты карты. Более того, фрагменты карты будут создаваться и сохраняться на сервере на лету по мере того, как игроки будут исследовать новые и новые территории. Для создания местности выбирается некая квадратная область на карте, которую необходимо создать и генерируется случайный ландшафт. Создаваемая область должна быть кратна целому числу фрагментов карты. Естественно, условием запуска создания фрагмента карты служит попадание ещё не созданного фрагмента карты в зону видимости игроку. Если по какой-то причине в зону видимости карты у игрока попал фрагмент, который не был создан или он в процессе создания, то вместо него отображается местность типа земля той местности, в которой игрок находится и этот фрагмент карты временно объявляется особой областью карты в которую нельзя попасть.

== 1.7 Координаты и расположение объектов в игровом мире ==

Под объектами понимаются любые сущности, которые располагаются на карте и имеют координаты: игрок, предмет, особая область. У каждого объекта есть особая точка, которая привязывает его к карте, координаты этой точки являются координатами этого объекта на карте. Координаты задаются в пикселах. При загрузке спрайтов объекта (если объект может быть нарисован и для этого имеется набор из одного или более спрайтов) для каждого спрайта указывается, в каком месте спрайта должна находится особая точка объекта. Например, если у нас есть игрок, для которого существует набор спрайтов человека, то логично, чтобы особая точка игрока, задающая его координаты на карте, всегда была совмещена с точкой, которая образуется проекцией центра тяжести нарисованных спрайтов человека на воображаемую плоскость, на которой он стоит, чтобы при движении и другой анимации, которую могут задавать спрайты человека, они выглядели естественно.

= 2. Игрок =

Игрок это персонаж, которым управляет человек, играющий в бродячую десу.

== 2.1 Характеристики игрока ==

У игрока есть три характеристики: *сила*, *скорость* и *здоровье*. Сила - это повреждения, наносимые игроком другим объектам игрового мира, если эти объекты допускают нанесение урона им. Сила измеряется в неких единицах силы. Скорость - скорость передвижения игрока по карте. Скорость измеряется в пикселах в секунду. Здоровье игрока - количество повреждений, которые игрок может выдержать прежде чем умрёт, когда его текущий уровень здоровья станет меньше либо равен 0. Здоровье измеряется в неких единицах здоровья. При увеличении какой-либо характеристики больше некоего заданного значения *ULTIMATE_POWER_LEVEL*, *ULTIMATE_SPEED_LEVEL*, *ULTIMATE_HEALTH_LEVEL* у игрока начинает проигрываться особая анимация, которая останавливается, когда значение какой-то характеристики станет меньше, чем указанное выше соответствующее значение.

== 2.2 Зона видимости игрока ==

У каждого игрока есть зона видимости радиуса *PLAYER_VISIBLE_RANGE* внутри которой он видит других игроков и их действия в реальном времени. Радиус задаётся в пикселах. Эта зона видимости меньше чем и целиком помещается во фрагменты карты, заданные *MAP_VISIBLE_RANGE* из пункта 1.2. Если игрок выходит за зону видимости другого игрока, то им обоим перестают передаваться данные друг о друге - они друг друга перестают видеть. Зона видимости подобрана так, чтобы она с запасом выходила за границу разрешения экранов большинства современных мониторов. В будущем радиус видимости игрока может увеличится. Радиус видимости игрока одинаков для всех игроков.

== 2.3 Движение игрока ==

Движение игрока осуществляется с помощью мыши. Чтобы заставить своего персонажа двигаться, нужно щелкнуть левой клавишей мыши в той точке карты, куда вы ходите пойти. При этом скорость движения игрока определяется характеристикой *скорость*, как указано в пункте 2.1. Если игрок в процессе своего движения входит в особую область, в которую нельзя попасть, то движение прерывается и персонаж остаётся стоять на месте. Если игрок в процессе движения атакует другого игрока или любую другую сущность игрового мира, которая допускает нанесение ей урона, то игрок останавливается и остаётся стоять на месте. Если игрок в процессе движения умирает, то движение прерывается в точке его гибели. Если игрок в процессе движения попадает в особую область, которая переносит его в другую точку игрового мира (телепорт), то движение также прерывается. Если в процессе движения игрок покидает игровой мир по какой-то причине, то его движение также прерывается и не будет возобновлено при его следующем входе в игровой мир. Использование предметов не прерывает движения игрока.

== 2.3 Поднятие предметов и Инвентарь ==

У каждого игрока есть инвентарь, в котором хранятся предметы, которые имеет игрок. Игрок может подбирать лежащие на земле предметы щелкнув на предмете левой клавишей мыши удерживая нажатой левую клавишу Ctrl. Радиус в котором игрок может понять предмет зависит от набора спрайтов игрока. Измеряется этот радиус в пикселах. Если предмет находится вне радиуса поднятия предметов, то при попытке поднять такой предмет автоматически запускается движение игрока к этому предмету, и после того как игрок подойдёт к предмету предмет можно будет поднять. При смерти игрока из его инвентаря может выпасть случайный предмет. Если во время того, как игрок движется к предмету чтобы затем поднять, другой игрок поднимает этот предмет, то движение не останавливается, но опаздывавший игрок не сможет поднять предмет дойдя до него. Игрок может просмотреть содержание своего инвентаря, нажав клавишу *i* на клавиатуре.

== 2.4 Использование предметов игроком ==

При просмотре инвентаря игрок может двойным щелчком левой клавишей мыши по предмету в инвентаре использовать этот предмет. Если предмет может быть использован, то к игроку будет применён эффект, который даёт этот предмет при использовании. Эффект от некоторых предметов можно отменить, повторно использовав их. Если при смерти из инвентаря игрока выпал предмет, эффект от которого был на умершем игроке, от эффект снимается.

== 2.5 Выделение цели и Атака игрока ==

Если игрок щелкает левой клавишей мыши, удерживая при этом нажатой клавишу Ctrl, на объекте игрового мира, который допускает выделение, то этот объект будет выбран в качестве цели его персонажа. После того как персонаж выбрал цель, он может атаковать её, нажав клавишу *F1* на клавиатуре. У разных игроков с разными спрайтами персонажей разная атака. У действия атака, как и у действия поднятия предмета, есть радиус измеряемый в пикселах. Аналогично с поднятием предмета, если цель игрока находится вне радиуса действия его атаки, игрок сначала движется к своей цели и только достигнув её атакует. Если в процессе движения к цели цель умирает, то движение к ней не останавливается. Атаковать мёртвую цель нельзя. При атаке цели наносится урон равный силе атакующего и у цели уменьшается текущее количество здоровья равное полученному урону. Атака некоторых игроков с некоторыми спрайтами не требует выделения цели и/или имеет радиус поражения заданный в пикселах. Так что при атаке цели все другие объекты, которые могут получить урон и находятся в радиусе поражения атаки, получают урон. Каждая атака имеет заданное время исполнения и частоту, с которой её можно использовать. Время исполнения атаки (или просто время атаки) и частота использования атаки зависят от набора спрайтов и не могут быть изменены в процессе игры.

= 3. Предметы =

Предметы одна сущностей игрового мира бродячей десы. Предметы можно поднимать, использовать, ронять.

== 3.1 Пути появления предметов в игровом мире ==

Предметы могут появится в игровом мире один путем: выпасть из инвентаря какой-то сущности при её смерти. Игрок может добывать предметы путем охоты на монстров или других игроков.

== 3.2 Хранение предметов в инвентаре и использование ==

Использование предметов было описано в 2.4. Предметы хранятся в инвентаре как было описано в 2.3. Кроме того, некоторые предметы могут быть удалены из инвентаря и из игрового мира после их использования - одноразовые предметы.

== 3.3 Удаление предметов из игрового мира ==

Предмет может быть удалён из игрового мира после использования, если это одноразовый предмет. Также предметы удаляются из инвентаря их владельца и из игрового мира после отключения их владельца от сервера. При перезапуске сервера все предметы удаляются.

== 3.4 Эффекты предметов при их использовании ==

При использовании предметов игроком срабатывает триггер, закреплённый за данным предметом и на игрока накладывается эффект от предмета. Предметы могут увеличивать характеристики их владельца, восстанавливать здоровье, запускать особую анимацию игрока, перемещать игрока в различные места игрового мира.